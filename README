------

# 跨站匿名个性化广告投放实验 — 开发文档

## 1. 项目概述

### 1.1  项目结构

本项目旨在设计一个实验性的跨站广告投放系统，实现匿名用户的个性化广告推荐。项目结构如下：

- **广告服务器（ads-server）**（部署在独立服务器上）
  - 提供广告脚本 `ad.js`
  - 提供基于ID的数据上报 API 接口，以接收信息
  - 后端连接数据库，存储用户信息、兴趣标签、兴趣指数情况
  - 提供基于ID的广告推荐下发接口
  - 提供广告业主的资源管理系统
- **三个独立网站**（部署在3个独立的服务器上）
  - `mall.com`：购物网站
  - `video.com`：视频网站
  - `news.com`：新闻网站
  - 每个网站通过引入广告商的 JS 脚本，与广告服务器数据交互，生成个性化广告推荐。

### 1.2  任务分配：

**广告商部分** ： [YuujinT]（https://github.com/YuujinT/）

**3个社媒设计：** [GAODUAN11 (Duan Gao)] (https://github.com/GAODUAN11)

**开发周期：2025.11 ~ 2025.12**

### 1.3 项目地址：

​	[YuujinT/ad-system: 团队Web课后作业]： https://github.com/YuujinT/ad-system

------

## 2. 技术栈

| 模块       | 技术                           |
| ---------- | ------------------------------ |
| Web 服务器 | Tomcat (Jakarta EE / Servlet)  |
| 数据库     | MySQL                          |
| 前端       | HTML + JavaScript (ad.js 脚本) |
| 网络通信   | Fetch (主动同步用户数据)       |
| 用户识别   | 浏览器指纹 FingerprintJS 库    |

------

## 3. 核心设计思路

### 3.1 用户 ID 生成

- 每个网站 **根据浏览器 fingerprint 生成 ID**：调用JavaScript的fingerprintjs库
  *浏览器指纹是**一种用于识别和追踪设备的技术，**它通过收集用户浏览器和设备的多种属性（如用户代理、屏幕分辨率、插件列表、字体、Canvas和WebGL特性等）来生成一个独特的标识符，用于识别和区分用户。*

------

### 3.2 用户行为标签收集与同步

- 用户在网站上的操作（点击带有兴趣标签的元素）由广告 JS 脚本收集上报
- 脚本通过 **fetch** 主动向广告商 API 发送 JSON 数据：

```
{
  "ID": "hashed_fingerprint",
  "tags": ["video", "sport", "shopping"]
}
```

- 广告服务器收到数据后：
  - 查找数据库中是否已有该 ID 与 兴趣标签
  - 若存在 → 更新兴趣标签次数记录（visit_count）
  - 若不存在 → 新建记录
- 每个网站仅负责生成 ID 与上传标签信息，广告商统一维护用户画像和推荐逻辑

------

### 3.3 兴趣标签管理与广告推荐

- 广告服务器根据用户ID、兴趣标签的访问情况生成个性化广告
- 广告数据下发给当前浏览器，由广告 JS 在页面中渲染

------

## 4. 数据库设计（广告商侧 MySQL）

### 4.1 user_tags 表

| 字段        | 类型           | 描述         |
| ----------- | -------------- | ------------ |
| ID          | VARCHAR(64) FK | 用户 ID      |
| tag_name    | VARCHAR(64)    | 兴趣标签名称 |
| visit_count | INT            | 标签访问次数 |

------

## 5. 流程概览

1. 用户访问 `video.com` 页面
2. 页面加载 `ad.js`
3. JS 收集浏览器 fingerprint 并生成 ID
4. JS 收集用户访问标签
5. JS 通过 fetch 将数据发送给广告服务器
6. 广告服务器匹配 fingerprint hash：
   - 若已存在 → 更新标签
   - 若不存在 → 创建新记录
7. 广告服务器生成个性化广告返回给网站
8. 用户访问其他网站（mall.com / news.com）时重复流程，广告服务器可识别同一用户，实现跨站广告推荐

------

## 6. 特点与优点

1. **简单实现**：每个网站直接用 fingerprintJS 库生成 ID
2. **隐私保护**：不存储原始 fingerprint
3. **跨站识别**：同一浏览器在不同网站生成的 fingerprint ID一致 → 可被广告商统一识别
4. **兼容实验环境**：无域名要求，仅通过 IP + API 即可完成实验
5. **可扩展**：可增加更多网站接入同一广告服务器，只需上传 fingerprint ID + 标签

------

